package net.javaci.bank202101.api.job;


import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertNotNull;
import static org.junit.jupiter.api.Assertions.assertTrue;

import java.io.StringReader;
import java.time.LocalDate;
import java.time.format.DateTimeFormatter;
import java.util.List;
import java.util.Map;

import org.junit.jupiter.api.Test;

import com.google.gson.Gson;

import net.javaci.bank202101.db.model.ExchangeRate;


public class ExchangeRateParserTest {

	private static String JSON = "{\n"
			+ "  \"result\": \"success\",\n"
			+ "  \"documentation\": \"https://www.exchangerate-api.com/docs\",\n"
			+ "  \"terms_of_use\": \"https://www.exchangerate-api.com/terms\",\n"
			+ "  \"time_last_update_unix\": 1619308801,\n"
			+ "  \"time_last_update_utc\": \"Sun, 25 Apr 2021 00:00:01 +0000\",\n"
			+ "  \"time_next_update_unix\": 1619395201,\n"
			+ "  \"time_next_update_utc\": \"Mon, 26 Apr 2021 00:00:01 +0000\",\n"
			+ "  \"base_code\": \"USD\",\n"
			+ "  \"conversion_rates\": {\n"
			+ "    \"USD\": 1,\n"
			+ "    \"AED\": 3.6725,\n"
			+ "    \"AFN\": 77.682,\n"
			+ "    \"ALL\": 102.2991,\n"
			+ "    \"AMD\": 521.8598,\n"
			+ "    \"ANG\": 1.79,\n"
			+ "    \"AOA\": 654.8643,\n"
			+ "    \"ARS\": 93.0195,\n"
			+ "    \"AUD\": 1.2926,\n"
			+ "    \"AWG\": 1.79,\n"
			+ "    \"AZN\": 1.6988,\n"
			+ "    \"BAM\": 1.6212,\n"
			+ "    \"BBD\": 2,\n"
			+ "    \"BDT\": 84.8357,\n"
			+ "    \"BGN\": 1.6211,\n"
			+ "    \"BHD\": 0.376,\n"
			+ "    \"BIF\": 1948.6635,\n"
			+ "    \"BMD\": 1,\n"
			+ "    \"BND\": 1.3262,\n"
			+ "    \"BOB\": 6.8752,\n"
			+ "    \"BRL\": 5.4564,\n"
			+ "    \"BSD\": 1,\n"
			+ "    \"BTN\": 74.8966,\n"
			+ "    \"BWP\": 10.8525,\n"
			+ "    \"BYN\": 2.5741,\n"
			+ "    \"BZD\": 2,\n"
			+ "    \"CAD\": 1.2468,\n"
			+ "    \"CDF\": 1980.3907,\n"
			+ "    \"CHF\": 0.9152,\n"
			+ "    \"CLP\": 704.7248,\n"
			+ "    \"CNY\": 6.4972,\n"
			+ "    \"COP\": 3660.6819,\n"
			+ "    \"CRC\": 613.6924,\n"
			+ "    \"CUC\": 1,\n"
			+ "    \"CUP\": 25.75,\n"
			+ "    \"CVE\": 91.3966,\n"
			+ "    \"CZK\": 21.4594,\n"
			+ "    \"DJF\": 177.721,\n"
			+ "    \"DKK\": 6.1838,\n"
			+ "    \"DOP\": 57.0596,\n"
			+ "    \"DZD\": 133.1271,\n"
			+ "    \"EGP\": 15.6674,\n"
			+ "    \"ERN\": 15,\n"
			+ "    \"ETB\": 41.9764,\n"
			+ "    \"EUR\": 0.8289,\n"
			+ "    \"FJD\": 2.0275,\n"
			+ "    \"FKP\": 0.721,\n"
			+ "    \"FOK\": 6.1838,\n"
			+ "    \"GBP\": 0.7211,\n"
			+ "    \"GEL\": 3.4489,\n"
			+ "    \"GGP\": 0.721,\n"
			+ "    \"GHS\": 5.7774,\n"
			+ "    \"GIP\": 0.721,\n"
			+ "    \"GMD\": 51.9242,\n"
			+ "    \"GNF\": 9948.7342,\n"
			+ "    \"GTQ\": 7.7054,\n"
			+ "    \"GYD\": 213.0904,\n"
			+ "    \"HKD\": 7.7634,\n"
			+ "    \"HNL\": 24.0261,\n"
			+ "    \"HRK\": 6.2452,\n"
			+ "    \"HTG\": 85.146,\n"
			+ "    \"HUF\": 301.3043,\n"
			+ "    \"IDR\": 14490.4507,\n"
			+ "    \"ILS\": 3.263,\n"
			+ "    \"IMP\": 0.721,\n"
			+ "    \"INR\": 74.8973,\n"
			+ "    \"IQD\": 1457.8722,\n"
			+ "    \"IRR\": 41990.2021,\n"
			+ "    \"ISK\": 125.3963,\n"
			+ "    \"JMD\": 152.5086,\n"
			+ "    \"JOD\": 0.709,\n"
			+ "    \"JPY\": 108.0202,\n"
			+ "    \"KES\": 108.4943,\n"
			+ "    \"KGS\": 84.8558,\n"
			+ "    \"KHR\": 4045.3231,\n"
			+ "    \"KID\": 1.2926,\n"
			+ "    \"KMF\": 407.7831,\n"
			+ "    \"KRW\": 1116.6928,\n"
			+ "    \"KWD\": 0.2996,\n"
			+ "    \"KYD\": 0.8333,\n"
			+ "    \"KZT\": 430.6715,\n"
			+ "    \"LAK\": 9414.8779,\n"
			+ "    \"LBP\": 1507.5,\n"
			+ "    \"LKR\": 193.2973,\n"
			+ "    \"LRD\": 172.503,\n"
			+ "    \"LSL\": 14.2759,\n"
			+ "    \"LYD\": 4.4773,\n"
			+ "    \"MAD\": 8.9047,\n"
			+ "    \"MDL\": 17.9596,\n"
			+ "    \"MGA\": 3775.7657,\n"
			+ "    \"MKD\": 51.0609,\n"
			+ "    \"MMK\": 1411.2512,\n"
			+ "    \"MNT\": 2847.8345,\n"
			+ "    \"MOP\": 7.9962,\n"
			+ "    \"MRU\": 35.9286,\n"
			+ "    \"MUR\": 40.3252,\n"
			+ "    \"MVR\": 15.4242,\n"
			+ "    \"MWK\": 790.2117,\n"
			+ "    \"MXN\": 19.8765,\n"
			+ "    \"MYR\": 4.1155,\n"
			+ "    \"MZN\": 55.4669,\n"
			+ "    \"NAD\": 14.2759,\n"
			+ "    \"NGN\": 399.1065,\n"
			+ "    \"NIO\": 35.093,\n"
			+ "    \"NOK\": 8.325,\n"
			+ "    \"NPR\": 119.8345,\n"
			+ "    \"NZD\": 1.3938,\n"
			+ "    \"OMR\": 0.3845,\n"
			+ "    \"PAB\": 1,\n"
			+ "    \"PEN\": 3.7536,\n"
			+ "    \"PGK\": 3.5167,\n"
			+ "    \"PHP\": 48.3901,\n"
			+ "    \"PKR\": 153.5231,\n"
			+ "    \"PLN\": 3.7791,\n"
			+ "    \"PYG\": 6424.2841,\n"
			+ "    \"QAR\": 3.64,\n"
			+ "    \"RON\": 4.0773,\n"
			+ "    \"RSD\": 97.5774,\n"
			+ "    \"RUB\": 75.1937,\n"
			+ "    \"RWF\": 999.4865,\n"
			+ "    \"SAR\": 3.75,\n"
			+ "    \"SBD\": 7.9604,\n"
			+ "    \"SCR\": 13.8814,\n"
			+ "    \"SDG\": 379.0468,\n"
			+ "    \"SEK\": 8.4082,\n"
			+ "    \"SGD\": 1.3262,\n"
			+ "    \"SHP\": 0.721,\n"
			+ "    \"SLL\": 10216.8942,\n"
			+ "    \"SOS\": 578.0796,\n"
			+ "    \"SRD\": 14.1435,\n"
			+ "    \"SSP\": 177.5713,\n"
			+ "    \"STN\": 20.3076,\n"
			+ "    \"SYP\": 1326.547,\n"
			+ "    \"SZL\": 14.2759,\n"
			+ "    \"THB\": 31.3721,\n"
			+ "    \"TJS\": 11.3147,\n"
			+ "    \"TMT\": 3.4993,\n"
			+ "    \"TND\": 2.7327,\n"
			+ "    \"TOP\": 2.2613,\n"
			+ "    \"TRY\": 8.312,\n"
			+ "    \"TTD\": 6.789,\n"
			+ "    \"TVD\": 1.2926,\n"
			+ "    \"TWD\": 28.1542,\n"
			+ "    \"TZS\": 2316.1761,\n"
			+ "    \"UAH\": 27.9416,\n"
			+ "    \"UGX\": 3599.8881,\n"
			+ "    \"UYU\": 44.0475,\n"
			+ "    \"UZS\": 10444.152,\n"
			+ "    \"VES\": 2634262.0504,\n"
			+ "    \"VND\": 23098.5131,\n"
			+ "    \"VUV\": 108.5253,\n"
			+ "    \"WST\": 2.5062,\n"
			+ "    \"XAF\": 543.7108,\n"
			+ "    \"XCD\": 2.7,\n"
			+ "    \"XDR\": 0.6965,\n"
			+ "    \"XOF\": 543.7108,\n"
			+ "    \"XPF\": 98.9121,\n"
			+ "    \"YER\": 250.6216,\n"
			+ "    \"ZAR\": 14.276,\n"
			+ "    \"ZMW\": 22.2488\n"
			+ "  }\n"
			+ "}";
	
	@Test
	public void testParse() {
		ExchangeRateParser parser = new ExchangeRateParser(new StringReader(JSON));
		
		List<ExchangeRate> exchangeRates = parser.parse();
		
		assertNotNull(exchangeRates);
		
		assertEquals(2, exchangeRates.size() );
		
	}
}
